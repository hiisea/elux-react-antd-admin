<div align="center">
    <img src="public/client/imgs/logo-icon-rotate.svg" alt="elux" width="200">
    <h2><a href="https://eluxjs.com">eluxjs.com</a></h2>
    <h3>åŸºäºâ€œå¾®æ¨¡å—â€å’Œâ€œæ¨¡å‹é©±åŠ¨â€çš„è·¨å¹³å°ã€è·¨æ¡†æ¶ã€åŒæ„æ–¹æ¡ˆã€</h3>
    <small>æ”¯æŒReact/Vue/Web(æµè§ˆå™¨)/Micro(å¾®å‰ç«¯)/SSR(æœåŠ¡å™¨æ¸²æŸ“)/MP(å°ç¨‹åº)/APP(æ‰‹æœºåº”ç”¨)</small>
</div>

## é¡¹ç›®ä»‹ç»

æœ¬é¡¹ç›®ä¸»è¦åŸºäº`Elux+Antd`æ„å»ºï¼ŒåŒ…å«`React`ç‰ˆæœ¬å’Œ`Vue`ç‰ˆæœ¬ï¼Œæ—¨åœ¨æä¾›ç»™å¤§å®¶ä¸€ä¸ª**ç®€å•åŸºç¡€**ã€**å¼€ç®±å³ç”¨**çš„åå°ç®¡ç†ç³»ç»Ÿé€šç”¨æ¨¡ç‰ˆï¼Œä¸»è¦åŒ…å«è¿è¡Œç¯å¢ƒã€è„šæ‰‹æ¶ã€ä»£ç é£æ ¼ã€åŸºæœ¬Layoutã€çŠ¶æ€ç®¡ç†ã€è·¯ç”±ç®¡ç†ã€å¢åˆ æ”¹æŸ¥é€»è¾‘ã€åˆ—è¡¨ã€è¡¨å•ç­‰ã€‚

> ä¸ºä¿æŒå·¥ç¨‹ç®€å•æ¸…çˆ½ï¼Œæ–¹ä¾¿äºŒæ¬¡å¼€å‘ï¼Œä¸æä¾›å„ç§çº·æ‚çš„å…·ä½“ä¸šåŠ¡ç»„ä»¶ï¼Œè¯·è§†å…·ä½“ä¸šåŠ¡è‡ªè¡ŒåŠ å…¥ï¼ˆç½‘ä¸Šå¾ˆå¤šï¼‰

## åœ¨çº¿é¢„è§ˆ

<http://admin-react-antd.eluxjs.com/>

## Gitä»“åº“

- Reactç‰ˆæœ¬
  - github: <https://github.com/hiisea/elux-react-antd-admin>
  - gitee: <https://gitee.com/hiisea/elux-react-antd-admin-fork>
- Vueç‰ˆæœ¬
  - github: <https://github.com/hiisea/elux-vue-antd-admin>
  - gitee: <https://gitee.com/hiisea/elux-vue-antd-admin-fork>

## å®‰è£…æ–¹æ³•

- ä½¿ç”¨Gitå‘½ä»¤cloneç›¸åº”çš„åº“ï¼š`git clone xxx`
- ä¹Ÿå¯ä»¥ä½¿ç”¨Eluxæä¾›çš„å‘½ä»¤ï¼š`npm create elux@latest æˆ– yarn create elux`

## âš ï¸æ³¨æ„äº‹é¡¹

å®‰è£…è¯·æ³¨æ„ï¼å®‰è£…è¯·æ³¨æ„ï¼å®‰è£…è¯·æ³¨æ„ï¼é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼Œå› ä¸ºä½¿ç”¨äº†`workspace`ï¼Œæ‰€ä»¥è¯·ä¿è¯ä½ çš„å®‰è£…ç¯å¢ƒï¼š

- Nodeç‰ˆæœ¬ >= 14.0.0
- æ¨èä½¿ç”¨ `yarn` å®‰è£…ä¾èµ–
- å¦‚æœä½¿ç”¨ `npm` å®‰è£…ä¾èµ–ï¼Œnpmç‰ˆæœ¬ >= 7.0

## ä½ çœ‹å¾—è§çš„UI

- ğŸš€ æä¾›é€šç”¨çš„Adminç³»ç»ŸLayoutï¼ˆåŒ…æ‹¬æ³¨å†Œã€ç™»å½•ã€å¿˜è®°å¯†ç ç­‰ï¼‰ã€‚
- ğŸš€ åŠ¨æ€è·å–Menuèœå•ã€è½®è¯¢æœ€æ–°æ¶ˆæ¯ç­‰ã€‚
- ğŸš€ æ”¯æŒç¬¬ä¸€æ¬¡åé€€æº¢å‡ºï¼Œè‡ªåŠ¨å›åˆ°é¦–é¡µï¼Œå†æ¬¡åé€€åˆ™å¼¹å‡ºæç¤ºï¼šæ‚¨ç¡®å®šè¦ç¦»å¼€æœ¬ç«™ï¼Ÿé˜²æ­¢ç”¨æˆ·è¯¯æ“ä½œã€‚![eluxæ”¶è—å¤¹](public/client/imgs/leave.jpg)
- æä¾›&lt;DocumentHead&gt;ç»„ä»¶ï¼Œæ–¹ä¾¿åœ¨SinglePageä¸­ç»´æŠ¤document titleã€keywordã€descriptionç­‰ï¼Œè¯¥ç»„ä»¶ä¹Ÿå¯ç”¨äºSSRï¼Œä¾‹å¦‚ï¼š

  ```ts
  <DocumentHead title={(id?'ä¿®æ”¹':'æ–°å¢')+'ç”¨æˆ·'} />
  ```

- ğŸš€ æä¾›é…ç½®å¼æŸ¥è¯¢è¡¨å•, è¿˜å¸¦TSç±»å‹éªŒè¯å“¦ï¼Œå†ä¹Ÿä¸æ‹…å¿ƒå†™é”™å­—æ®µåï¼š

  ```ts
  const formItems: SearchFromItems<ListSearchFormData> = [
    {name: 'name', label: 'ç”¨æˆ·å', formItem: <Input placeholder="è¯·è¾“å…¥å…³é”®å­—" />},
    {name: 'nickname', label: 'å‘¢ç§°', formItem: <Input placeholder="è¯·è¾“å…¥å‘¢ç§°" />},
    {name: 'status', label: 'çŠ¶æ€', formItem: <Select placeholder="è¯·é€‰æ‹©ç”¨æˆ·çŠ¶æ€" />},
    {name: 'role', label: 'è§’è‰²', formItem: <Select placeholder="è¯·é€‰æ‹©ç”¨æˆ·çŠ¶æ€" />},
    {name: 'email', label: 'Email', formItem: <Input placeholder="è¯·è¾“å…¥Email" />},
  ];
  ```

- ğŸš€ æä¾›å±•å¼€ä¸éšè—é«˜çº§æœç´¢ï¼š[å±•å¼€é«˜çº§](http://admin-react-antd.eluxjs.com/admin/member/list/maintain?email=u.mese%40jww.gh)Â /Â [éšè—é«˜çº§](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)
- ğŸš€ æä¾›è·¨é¡µé€‰å–ã€é‡æ–°æœç´¢åé€‰å–ã€reviewå·²é€‰å–ï¼š[è·¨é¡µé€‰å–](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)
- ğŸš€ æä¾›é…ç½®å¼æ‰¹é‡æ“ä½œç­‰åŠŸèƒ½ï¼Œå¦‚ï¼š[æ‰¹é‡æ“ä½œ](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)

  ```ts
  const batchActions = {
      actions: [
        {key: 'delete', label: 'æ‰¹é‡åˆ é™¤', confirm: true},
        {key: 'resolved', label: 'æ‰¹é‡é€šè¿‡', confirm: true},
        {key: 'rejected', label: 'æ‰¹é‡æ‹’ç»', confirm: true},
      ],
      handler: (item: {key: string}, ids: (string | number)[]) => {
        if (item.key === 'delete') {
          deleteItems(ids as string[]);
        } else if (item.key === 'resolved') {
          alterItems(ids as string[], {status: Status.å®¡æ ¸é€šè¿‡});
        } else if (item.key === 'rejected') {
          alterItems(ids as string[], {status: Status.å®¡æ ¸æ‹’ç»});
        }
      },
    };
  ```

- ğŸš€ æä¾›èµ„æºé€‰æ‹©å™¨ï¼Œå¹¶å°è£…æˆselectï¼Œå¯å•é€‰ã€å¤šé€‰ã€é€‰æ»¡è‡ªåŠ¨æäº¤ï¼Œå¦‚ï¼š[åˆ›å»ºæ–‡ç« æ—¶ï¼ŒæŸ¥è¯¢å¹¶é€‰æ‹©è´£ä»»ç¼–è¾‘](http://admin-react-antd.eluxjs.com/admin/article/item/edit?__c=_dialog)

  ```jsx
  <FormItem {...fromDecorators.editors}>
    <MSelect<MemberListSearch>
      placeholder="è¯·é€‰æ‹©è´£ä»»ç¼–è¾‘"
      selectorPathname="/admin/member/list/selector"
      fixedSearch={{role: Role.è´£ä»»ç¼–è¾‘, status: Status.å¯ç”¨}}
      limit={[1, 2]}
      returnArray
      showSearch
    ></MSelect>
  </FormItem>
  ```

- ğŸš€ æä¾›æ”¶è—å¤¹ä¹¦ç­¾åŠŸèƒ½ï¼Œç”¨å…¶ä»£æ›¿Pageé€‰é¡¹å¡ï¼Œæ“ä½œæ›´çµæ´»ã€‚ç‚¹å‡»å·¦ä¸Šè§’[ã€+æ”¶è—ã€‘](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)è¯•è¯•... ![eluxæ”¶è—å¤¹](public/client/imgs/favs.jpg)
- ğŸš€ æä¾›é¡µå†…åˆ·æ–°åŠŸèƒ½ã€‚ç‚¹å‡»å³ä¸Šè§’[ã€åˆ·æ–°æŒ‰é’®ã€‘](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)è¯•è¯•...
- ğŸš€ è™šæ‹ŸWindow
  - è·¯ç”±è·³è½¬æ—¶å¯ä»¥åœ¨æ–°çš„è™šæ‹Ÿçª—å£ä¸­æ‰“å¼€ï¼Œç±»ä¼¼äºtarget='_blank'ï¼Œä½†æ˜¯è™šæ‹ŸWindowå“¦ï¼Œå¦‚ï¼š[æ–°çª—å£æ‰“å¼€](http://admin-react-antd.eluxjs.com/admin/article/list/index?author=48&__c=_dialog)Â /Â [æœ¬çª—å£æ‰“å¼€](http://admin-react-antd.eluxjs.com/admin/article/list/index?author=48)
  - çª—å£ä¸­å¯ä»¥å†å¼€æ–°çª—å£ï¼Œæœ€å¤šå¯è¾¾10çº§
  - å¼¹çª—å†å¼¹å¼¹çª—ä½“éªŒä¸å¥½ï¼Ÿå¤šå±‚å¼¹çª—æ—¶è‡ªåŠ¨éšè—ä¸‹å±‚å¼¹çª—ï¼Œå…³é—­ä¸Šå±‚å¼¹çª—è‡ªåŠ¨æ¢å¤ä¸‹å±‚å¼¹çª—ï¼Œä¿è¯æ¯ä¸€æ—¶åˆ»å§‹ç»ˆä¹‹ä¼šå‡ºç°ä¸€å±‚å¼¹çª—
  - å®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„Windowï¼ˆéç®€å•çš„Dialogï¼‰ï¼Œæ¯ä¸ªçª—å£ä¸ä»…æ‹¥æœ‰ç‹¬ç«‹çš„Domã€çŠ¶æ€ç®¡ç†Storeã€è¿˜è‡ªåŠ¨ç»´æŠ¤ç‹¬ç«‹çš„`å†å²è®°å½•æ ˆ`
  - æä¾›çª—å£å·¥å…·æ¡ï¼šåé€€ã€åˆ·æ–°ã€å…³é—­ï¼Œå¦‚ï¼š[æ–‡ç« åˆ—è¡¨](http://admin-react-antd.eluxjs.com/admin/article/list/index?author=48&__c=_dialog) => ç‚¹å‡»æ ‡é¢˜ => ç‚¹å‡»ä½œè€… => ç‚¹å‡»æ–‡ç« æ•°ã€‚ç„¶åä½ å¯ä»¥ä¾æ¬¡å›é€€æ¯ä¸€æ­¥æ“ä½œï¼Œä¹Ÿå¯ä¸€æ¬¡æ€§å…¨éƒ¨å…³é—­ã€‚
  - æä¾›çª—å£æœ€å¤§åŒ–ã€æœ€å°åŒ–æŒ‰é’®ï¼Œå¦‚ï¼š[æ–‡ç« è¯¦æƒ…ï¼Œçª—å£å·¦ä¸Šè§’æŒ‰é’®](http://admin-react-antd.eluxjs.com/admin/article/item/detail/50?__c=_dialog)ï¼›å¹¶æ”¯æŒé»˜è®¤æœ€å¤§åŒ–ï¼Œå¦‚ï¼š[åˆ›å»ºæ–‡ç« ](http://admin-react-antd.eluxjs.com/admin/article/item/edit?__c=_dialog) ![eluxè™šæ‹Ÿçª—å£](public/client/imgs/window.jpg)
  - çª—å£å¯ä»¥é€šè¿‡Urlå‘é€ï¼Œå¦‚å°†`http://admin-react-antd.eluxjs.com/admin/member/item/edit/50?__c=_dialog`å‘é€ç»™å¥½å‹åï¼Œå…¶å¯ä»¥é€šè¿‡Urlè¿˜åŸçª—å£ã€‚
  - è½»æ¾å®ç°keep-aliveã€‚keep-aliveä¼˜ç‚¹æ˜¯ç”¨æˆ·ä½“éªŒå¥½ï¼Œç¼ºç‚¹æ˜¯å¤ªå èµ„æºï¼ˆéœ€è¦ç¼“å­˜æ‰€æœ‰Domå…ƒç´ è¿˜æœ‰ç›¸å…³å†…å­˜å˜é‡ï¼‰ï¼Œç°åœ¨ä½¿ç”¨è™šæ‹ŸWindwï¼Œä½ æƒ³keep-aliveå°±åœ¨æ–°çª—å£ä¸­æ‰“å¼€ï¼Œä¸æƒ³keep-aliveå°±åœ¨åŸçª—å£ä¸­æ‰“å¼€ï¼Œå…³é—­çª—å£å°±è‡ªåŠ¨é”€æ¯keep-alive
  
- ğŸš€ åŸºäºæŠ½è±¡çš„å¢åˆ æ”¹æŸ¥é€»è¾‘ï¼š
  - ä¸šåŠ¡é€»è¾‘é€šè¿‡ç±»çš„ç»§æ‰¿å¤ç”¨ï¼Œå¦‚æœæ˜¯æ ‡å‡†çš„å¢åˆ æ”¹æŸ¥åŸºæœ¬ä¸Šä¸ç”¨å†™ä»£ç ï¼Œå¦åˆ™å¯ä»¥è‡ªå·±è¦†ç›–çˆ¶ç±»ä¸­çš„æŸäº›æ–¹æ³•ï¼š

  ```ts
  export class Model extends BaseResource<MemberResource> {
    protected api = api;
    protected defaultListSearch = defaultListSearch;
  }
  ```

  - UIé€»è¾‘é€šè¿‡`Hooks`å¤ç”¨ã€‚
  - å°†è§†å›¾æŠ½è±¡æˆä¸º2å¤§ç±»ï¼š*åˆ—è¡¨*(List)å’Œ*å•æ¡*(Item)ï¼ŒæŠ½å–å…¶å…±æ€§ã€‚
  - åœ¨æ­¤åŸºç¡€ä¸Šå¼•å…¥è§†å›¾`æ¸²æŸ“å™¨(Render)`æ¦‚å¿µï¼Œç±»åˆ«å+æ¸²æŸ“å™¨=å…·ä½“æŸä¸ªä¸šåŠ¡è§†å›¾ï¼Œå¦‚ï¼š
    - type=list,render=maintain(åˆ—è¡¨+ç»´æŠ¤)ï¼Œå¦‚ï¼š[/admin/member/list/maintain](http://admin-react-antd.eluxjs.com/admin/member/list/maintain)
    - type=list,render=index(åˆ—è¡¨+å±•ç¤º)ï¼Œå¦‚ï¼š[/admin/article/list/index](http://admin-react-antd.eluxjs.com/admin/article/list/index?author=49&__c=_dialog)
    - type=list,render=selector(åˆ—è¡¨+é€‰æ‹©)ï¼Œå¦‚ï¼š[/admin/member/list/selector](http://admin-react-antd.eluxjs.com/admin/member/list/selector?role=editor&status=enable&__c=_dialog)
    - type=item,render=detail(å•æ¡+å±•ç¤º)ï¼Œå¦‚ï¼š[/admin/member/item/detail/49](http://admin-react-antd.eluxjs.com/admin/member/item/detail/49?__c=_dialog)
    - type=item,render=edit(å•æ¡+ç¼–è¾‘)ï¼Œå¦‚ï¼š[/admin/member/item/edit/49](http://admin-react-antd.eluxjs.com/admin/member/item/edit/49?__c=_dialog)

## ä½ çœ‹ä¸è§çš„å¹•å

- ğŸš€ ä½¿ç”¨å¾®æ¨¡å—æ¶æ„ï¼Œå°†ä¸šåŠ¡åŠŸèƒ½å°è£…æˆç‹¬ç«‹å¾®æ¨¡å—ï¼Œæƒ³è¦å“ªä¸ªåŠŸèƒ½å°±å®‰è£…å“ªä¸ªæ¨¡å—ï¼Œæ˜¯ä¸€ç§ç²’åº¦æ›´ç»†çš„å¾®å‰ç«¯

  ```txt
   ä½ ä»¥å‰çš„SRCé•¿è¿™æ ·ï¼Ÿï¼Ÿï¼Ÿ
    â”‚
    â”œâ”€ src
    â”‚  â”œâ”€ api                 # APIæ¥å£ç®¡ç†
    â”‚  â”œâ”€ assets              # é™æ€èµ„æºæ–‡ä»¶
    â”‚  â”œâ”€ components          # å…¨å±€ç»„ä»¶
    â”‚  â”œâ”€ config              # å…¨å±€é…ç½®é¡¹
    â”‚  â”œâ”€ directives          # å…¨å±€æŒ‡ä»¤æ–‡ä»¶
    â”‚  â”œâ”€ enums               # é¡¹ç›®æšä¸¾
    â”‚  â”œâ”€ hooks               # å¸¸ç”¨ Hooks
    â”‚  â”œâ”€ language            # è¯­è¨€å›½é™…åŒ–
    â”‚  â”œâ”€ layout              # æ¡†æ¶å¸ƒå±€
    â”‚  â”œâ”€ routers             # è·¯ç”±ç®¡ç†
    â”‚  â”œâ”€ store               # store
    â”‚  â”œâ”€ styles              # å…¨å±€æ ·å¼
    â”‚  â”œâ”€ typings             # å…¨å±€ ts å£°æ˜
    â”‚  â”œâ”€ utils               # å·¥å…·åº“
    â”‚  â”œâ”€ views               # é¡¹ç›®æ‰€æœ‰é¡µé¢
    â”‚  â”œâ”€ App.vue             # å…¥å£é¡µé¢
    â”‚  â””â”€ main.ts             # å…¥å£æ–‡ä»¶
  ```

   å¿«æ¥æ‹¯æ•‘ä½ çš„SRCğŸ”¥ï¼Œ

  ```txt
  ä½¿ç”¨å¾®æ¨¡å—åSRCé•¿è¿™æ ·ï¼ï¼ï¼
    â”‚
    â”œâ”€ src
    â”‚  â”œâ”€ moddules            # å„ä¸šåŠ¡å¾®æ¨¡å—
    â”‚  â”‚    â”œâ”€ user
    â”‚  â”‚    â”œâ”€ article        
    â”‚  â”‚    â”œâ”€ comment   
    â”‚  â”œâ”€ Project.vue         # å„å¾®æ¨¡å—èšåˆé…ç½®
    â”‚  â””â”€ index.ts            # å…¥å£æ–‡ä»¶
  ```

  - å¾®æ¨¡å—æ”¯æŒåŒæ­¥/å¼‚æ­¥åŠ è½½
  - å¾®æ¨¡å—æ”¯æŒæœ¬åœ°ç›®å½•ã€æ”¯æŒå‘å¸ƒæˆNPMåŒ…ï¼Œæ”¯æŒç‹¬ç«‹éƒ¨ç½²ï¼ˆå¾®å‰ç«¯ï¼‰
  - å¾®æ¨¡å—æ”¯æŒæ•´ä½“TSç±»å‹éªŒè¯ä¸æç¤º
  
- ğŸš€ å†…ç½®æœ€å¼ºçŠ¶æ€ç®¡ç†æ¡†æ¶(^-^)ï¼š
  - åŒæ—¶æ”¯æŒReact/Vueï¼Œä¸å†æ·±åº¦è€¦åˆUIæ¡†æ¶ã€‚
  - æœ€å¤§ç¨‹åº¦ç®€åŒ–actionå’Œstoreçš„å†™æ³•

  ```ts
  export class Model extends BaseMode {

    @reducer //ç±»ä¼¼Vuexçš„mutations
    public putCurUser(curUser: CurUser) {
      this.state.curUser = curUser; // vueä¸­å¯ç›´æ¥ä¿®æ”¹
      //this.state = {...this.state, curUser} reactä¸­
    }

    @effect() //ç±»ä¼¼Vuexçš„action
    public async login(args: LoginParams) {
      const curUser = await api.login(args);
      this.dispatch(this.actions.putCurUser(curUser));
      this.getRouter().relaunch({url: AdminHomeUrl}, 'window');
    }
  }
  ```

  - ä¸è·¯ç”±ç»“åˆï¼Œæ”¯æŒStoreå¤šå®ä¾‹ã€‚
  - è·¯ç”±è·³è½¬æ—¶è‡ªåŠ¨æ¸…ç©ºStoreï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒStateåœ¨Storeä¸­æ— é™ç´¯ç§¯ã€‚
  - ä¸ºactionå¼•å…¥çº¿ç¨‹æœºåˆ¶ï¼Œæ”¯æŒåœ¨å¤„ç†actionçš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æ´¾ç”Ÿå‡ºæ–°çš„actionçº¿ç¨‹ã€‚
  - actionæ‰§è¡Œä¸­æ”¯æŒå¼‚æ­¥æ“ä½œï¼š

  ```ts
  @effect()
  public async updateItem(id: string, data: UpdateItem) {
    await this.api.updateItem!({id, data}); //è°ƒç”¨åå°API
    await this.getRouter().back(1, 'window'); //è·¯ç”±åé€€ä¸€æ­¥(åˆ°åˆ—è¡¨é¡µ)
    message.success('ç¼–è¾‘æˆåŠŸï¼'); //æç¤º
    this.getRouter().back(0, 'page'); //back(0)è¡¨ç¤ºåˆ·æ–°å½“å‰é¡µ(åˆ—è¡¨é¡µ)
  }
  ```

  - æ”¯æŒawiat actionçš„æ‰§è¡Œç»“æœï¼Œå¦‚åœ¨UIä¸­ç­‰å¾…loginè¿™ä¸ªactionçš„æ‰§è¡Œç»“æœï¼š

  ```ts
  const onSubmit = (values: HFormData) => {
    const result = dispatch(stageActions.login(values));
    //stageActions.login()ä¸­åŒ…å«å¼‚æ­¥è¯·æ±‚ï¼Œè¿”å›Promise

    result.catch(({message}) => {
      //å¦‚æœå‡ºé”™(å¯†ç é”™è¯¯)ï¼Œåœ¨formä¸­å±•ç¤ºå‡ºé”™ä¿¡æ¯
      form.setFields([{name: 'password', errors: [message]}]);
    });
  };
  ```

  - ä¸ºactionå¼•å…¥äº‹ä»¶æœºåˆ¶ï¼Œdispatchä¸€ä¸ªactionæ”¯æŒå¤šå¤„ç›‘å¬ï¼Œå…±åŒåä½œå®Œæˆä¸€ä¸ªé•¿æµç¨‹ä¸šåŠ¡ã€‚ä¾‹å¦‚ï¼šModelA å’Œ ModelB éƒ½æƒ³ç›‘å¬`ç”¨æˆ·åˆ‡æ¢`è¿™ä¸ªActionï¼š

  ```ts
  // ModelA:
  export class ModelA extends BaseResource {
    @effect()
    public async ['stage.putCurUser'](user: User) {
      if (user.hasLogin) {
          this.dispath(this.actions.xxx());
      } else {
          this.dispath(this.actions.xxx());
      }
    }
  }

  // ModelB:
  export class ModelB extends BaseResource{
    @effect()
    public async ['stage.putCurUser'](user: User) {
      if (user.hasLogin) {
          this.dispath(this.actions.xxx());
      } else {
          this.dispath(this.actions.xxx());
      }
    }
  }
  ```

  - è·¯ç”±è·³è½¬å‰ä¼šè‡ªåŠ¨æ´¾å‘`stage._testRouteChange`çš„actionï¼Œä½ å¯ä»¥ç›‘å¬å®ƒï¼Œé˜»æ­¢è·¯ç”±è·³è½¬ï¼š

  ```ts
  @effect(null)
  protected async ['this._testRouteChange']({url, pathname}) {
      if (!this.state.curUser.hasLogin && this.checkNeedsLogin(pathname)) {
          throw new CustomError(CommonErrorCode.unauthorized, 'è¯·ç™»å½•ï¼');
      }
  }
  ```

  - æ”¯æŒcatch actionæ‰§è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ï¼Œå¹¶å†³å®šç»§ç»­æˆ–ç»ˆæ­¢å½“å‰actionæ‰§è¡Œï¼š

  ```ts
  @effect(null)
  protected async ['this._error'](error: CustomError) {
      if (error.code === CommonErrorCode.unauthorized) {
          this.getRouter().push({url: '/login'}, 'window');
      }else{
          alert(error.message);
      }
      throw error;
  }
  ```

  - æœ€æ–¹ä¾¿çš„æ³¨å…¥loadingçŠ¶æ€ï¼Œæƒ³è¦è·Ÿè¸ªå¼‚æ­¥actionçš„æ‰§è¡Œæƒ…å†µï¼Ÿåªéœ€è¦åœ¨å£°æ˜æ–¹æ³•ä¸­ä¼ äººkeyåå°±è¡Œäº†ï¼Œå¦‚ï¼š

    ```ts
    @effect('this.listLoading') //å°†è¯¥å¼‚æ­¥actionçš„æ‰§è¡ŒçŠ¶æ€æ³¨å…¥this.state.listLoadingä¸­
    public async fetchList(listSearchData?: TDefineResource['ListSearch']) {
      const listSearch = listSearchData || this.state.listSearch || this.defaultListSearch;
      const {list, listSummary} = await this.api.getList!(listSearch);
      this.dispatch(this.privateActions.putList(listSearch, list, listSummary));
    }
    ```

  - æ­¦è£…åˆ°ç‰™é½¿çš„Typescriptæ™ºèƒ½æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨ï¼ˆå¹¶ä¸”ç±»å‹è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹å†™ï¼‰ï¼š![elux-ts](public/client/imgs/type.jpg)
  
- ğŸš€ æä¾›åŸºäºåŒæ ˆå•é“¾çš„è™šæ‹Ÿè·¯ç”±ã€‚
  - æ‹¥æœ‰2ç»´å†å²è®°å½•æ ˆï¼Œå°†åŸç”Ÿè·¯ç”±ä½“éªŒå¸¦å…¥æµè§ˆå™¨ã€‚

  ```ts
  router.push({url: '/login'}, 'page') //åœ¨å½“å‰é¡µå†å²è®°å½•æ ˆä¸­æ–°å¢ä¸€æ¡å†å²è®°å½•
  router.push({url: '/login'}, 'window') //åœ¨æ–°çª—å£å†å²è®°å½•æ ˆä¸­æ–°å¢ä¸€æ¡å†å²è®°å½•
  ```

  - åŸºäºè™šæ‹Ÿè·¯ç”±ï¼Œä¸å†ç›´æ¥å…³è”åŸç”Ÿè·¯ç”±ï¼Œä¸­é—´å¯ä»¥è½¬æ¢æ˜ å°„ã€‚å¦‚åœ¨å°ç¨‹åºä¸­æ˜ å°„ï¼š

  ```ts
  const NativePathnameMapping = {
    in(nativePathname) { //å°†å°ç¨‹åºè·¯ç”±åœ°å€æ˜ å°„ä¸ºè™šæ‹Ÿè·¯ç”±åœ°å€
      if (nativePathname === '/') {
        nativePathname = '/modules/article/pages/list';
      }
      const Prefix = {my: '/admin'};
      return nativePathname.replace(/^\/modules\/(\w+)\/pages\//, (match, moduleName) => {
        return (Prefix[moduleName] || '')+'/'+moduleName+'/';
      });
    },
    out(internalPathname) { //å°†è™šæ‹Ÿè·¯ç”±åœ°å€æ˜ å°„ä¸ºå°ç¨‹åºè·¯ç”±åœ°å€
      internalPathname = internalPathname.replace('/admin/', '/');
      return internalPathname.replace(/^\/(\w+)\//, '/modules/$1/pages/');
    },
  }
  ```

  - è·¨å¹³å°ï¼Œå¯ç”¨äºæµè§ˆå™¨ã€æœåŠ¡å™¨SSRã€å°ç¨‹åºã€åŸç”Ÿåº”ç”¨ã€‚
  - è·¨æ¡†æ¶ï¼Œå¯ç”¨äºReactã€Vueï¼Œä¸ä¾èµ–å…¶å®ƒè·¯ç”±æ¡†æ¶ï¼Œå¦‚react-routerã€vue-router
  - å¯å®Œæ•´ä¿å­˜å†å²å¿«ç…§ï¼ŒåŒ…æ‹¬Storeå’ŒDomå…ƒç´ 
  - å¯è®¿é—®å’ŒæŸ¥æ‰¾å†å²è®°å½•ï¼Œä¸å†åªæ˜¯ä¸€ä¸ªhistory.length

  ```ts
  const length = router.getHistoryLength(); //è·å–å†å²æ ˆä¸­çš„è®°å½•æ•°
  const list = router.getHistory(); //è·å–æ‰€æœ‰å†å²è®°å½•
  const record = router.findRecordByStep(10); //è·å–10æ­¥ä¹‹å‰çš„å†å²è®°å½•
  const record2 = router.findRecordByKey('8_1'); //è·å–ç¼–å·ä¸º8_1çš„å†å²è®°å½•
  ```

    ä¾‹å¦‚ç™»å½•çª—å£ä¸­ç‚¹å‡»â€œå–æ¶ˆç™»å½•â€ä½ éœ€è¦å›é€€åˆ°å‰ä¸€ä¸ªé¡µé¢ï¼Œä½†æ­¤æ—¶å¦‚æœå‰ä¸€ä¸ªé¡µé¢å°±æ˜¯éœ€è¦ç™»å½•çš„é¡µé¢ï¼Œé‚£ä¹ˆç™»å½•çª—å£åˆä¼šè¢«é‡æ–°å¼¹å‡ºã€‚æ‰€ä»¥ç‚¹å‡»â€œå–æ¶ˆç™»å½•â€åº”å½“å›é€€åˆ°æœ€è¿‘çš„ä¸éœ€è¦ç™»å½•çš„é¡µé¢ï¼š

  ```ts
  @effect()
  public async cancelLogin(): Promise<void> {
    //åœ¨å†å²æ ˆä¸­æ‰¾åˆ°ç¬¬ä¸€æ¡ä¸éœ€è¦ç™»å½•çš„è®°å½•
    //å¦‚æœç®€å•çš„back(1)ï¼Œå‰ä¸€ä¸ªé¡µé¢éœ€è¦ç™»å½•æ—¶ä¼šå¼•èµ·å¾ªç¯
    this.getRouter().back((record) => {
      return !this.checkNeedsLogin(record.location.pathname);
    }, 'window');
  }
  ```

  - æ”¯æŒè·¯ç”±æ‹¦æˆªå’Œè·¯ç”±å®ˆå«
  - æ”¯æŒåé€€æº¢å‡ºæ—¶é‡å®šå‘ï¼Œæ¯”å¦‚é˜²æ­¢ç”¨æˆ·åé€€è¿‡å¤šï¼Œä¸å°å¿ƒé€€å‡ºäº†æœ¬ç«™ï¼š

  ```ts
  @effect(null)
  protected async ['this._error'](error: CustomError): Promise<void> {
    if (error.code === ErrorCodes.ROUTE_BACK_OVERFLOW) {
      const redirect: string = HomeUrl;
      //å¦‚æœå·²ç»æ—¶ä¸»é¡µï¼Œåˆ™æç¤ºç”¨æˆ·æ˜¯å¦é€€å‡ºæœ¬ç«™ï¼Ÿ
      if (this.getRouter().location.url === redirect && window.confirm('ç¡®å®šè¦é€€å‡ºæœ¬ç«™å—ï¼Ÿ')){
        //æ³¨æ„: back('')å¯ä»¥é€€å‡ºæœ¬ç«™
        setTimeout(() => this.getRouter().back('', 'window'), 0);
      } else {
        //å¦‚æœä¸æ˜¯åœ¨ä¸»é¡µï¼Œåˆ™å…ˆå›åˆ°ä¸»é¡µ
        setTimeout(() => this.getRouter().relaunch({url: redirect}, 'window'), 0);
      }
    };
  }
  ```

  - å¯è·Ÿè¸ªå’Œç­‰å¾…è·¯ç”±è·³è½¬å®Œæˆã€‚ä¾‹å¦‚ä¿®æ”¹ç”¨æˆ·åï¼Œéœ€è¦è¿”å›åˆ—è¡¨é¡µé¢å¹¶åˆ·æ–°ï¼š

  ```ts
  @effect()
  public async updateItem(id: string, data: UpdateItem) {
    await this.api.updateItem!({id, data});
    await this.getRouter().back(1, 'window'); //å¯awaitè·¯ç”±åé€€
    message.success('ç¼–è¾‘æˆåŠŸï¼');
    this.getRouter().back(0, 'page'); //back(0)å¯åˆ·æ–°é¡µé¢
  }
  ```

  - æä¾›æ›´å¤šè·¯ç”±è·³è½¬æ–¹æ³•

  ```ts
  router.push(location, target); //æ–°å¢
  router.replace(location, target); //æ›¿æ¢
  router.relaunch(location, target); //é‡ç½®
  router.back(stepOrCallback, target) //åé€€æˆ–åˆ·æ–°
  ```

- ğŸš€ æä¾›ä¸é¡¹ç›®åŒæ„çš„æœ¬åœ°MockServerï¼ŒMockServerä¹Ÿä½¿ç”¨Typescriptï¼Œä½†æ— éœ€å†å†™ç±»å‹æ–‡ä»¶ï¼Œç›´æ¥ä»`src/`ä¸‹é¢ä¸é¡¹ç›®å…±äº«ï¼Œæ”¯æŒä¿®æ”¹è‡ªåŠ¨é‡å¯ã€‚
- ğŸš€ å¼€ç®±å³ç”¨çš„è„šæ‰‹æ¶ã€‚æä¾›å°è£…å¥½çš„`Cliå‘½ä»¤è¡Œ`è„šæ‰‹æ¶ï¼Œä¸ç”¨è‡ªå·±æŠ˜è…¾ï¼š![eluxè„šæ‰‹æ¶](public/client/imgs/cli.jpg)
- ğŸš€ åŸºæœ¬çš„`eslint/stylelint/babel`éƒ½å·²ç»å¸®ä½ æ‰“åŒ…å¥½äº†ï¼Œä¸ç”¨å®‰è£…å„ç§æ’ä»¶å’Œå†™ä¸€å¤§å †ä¾èµ–ï¼š

  ```json
  "devDependencies": {
    "@elux/babel-preset": "^1.0.2",
    "@elux/eslint-plugin": "^1.2.2",
    "@elux/stylelint-config": "^1.1.1"
  }
  ```

- ğŸš€ æœªå®Œå¾…ç»­...

## ä¸ä½¿ç”¨NPMç®¡ç†å¾®æ¨¡å—

é¡¹ç›®ä¸­çš„`å¾®æ¨¡å—`é»˜è®¤æ˜¯ä½¿ç”¨NPMåŒ…æ¥ç®¡ç†çš„ï¼Œæ¯ä¸ªå¾®æ¨¡å—ä¸‹éƒ½æœ‰ä¸€ä¸ª`package.json`æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š`src/modules/admin/package.json`ï¼Œå¼€å‘æ—¶ä½¿ç”¨äº†`workspace`å’Œ`monorepo`æ¥ç®¡ç†ï¼š

```json
  "workspaces": [
    "./mock",
    "./public",
    "./src/modules/*"
  ],
```

è·¨`å¾®æ¨¡å—`å¼•ç”¨æ—¶ï¼Œç”¨çš„æ˜¯npmåŒ…åï¼Œä¾‹å¦‚ï¼š

```ts
import {ListSearch} from '@elux-admin-antd/member/entity';
```

`å¾®æ¨¡å—`æœ€å¤§çš„å¥½å¤„è¿˜æ˜¯åœ¨äº**é«˜å†…èšï¼Œä½è€¦åˆ**ï¼Œè‡³äºæ˜¯å¦è¦ç”¨npmæ¥ç®¡ç†ï¼Œä¸æ˜¯å¿…é¡»çš„ã€‚å¦‚æœä½ ä¸æƒ³ç»•è¿™ä¹ˆä¸€ä¸ªåœˆï¼Œä¹Ÿå¯ä»¥åˆ†åˆ†é’Ÿæ”¹æˆæ™®é€šçš„å•ä½“ç»“æ„ï¼š

```ts
import {ListSearch} from '@/modules/member/entity';
```

åªéœ€è¦åœ¨`src/tsconfig.json`ä¸­åŠ å…¥pathsåˆ«åå°±å¯ä»¥äº†ï¼š

```json
"paths": {
  "@/*": ["./*"]
}
```

## Vueç‰ˆç‰¹åˆ«è¯´æ˜

Vueç‰ˆ/Reactç‰ˆä¿æŒåŒæ­¥ï¼Œç”±äº[Elux](https://eluxjs.com)è·µè¡Œâ€œ**æ¨¡å‹é©±åŠ¨**â€çš„æ¶æ„ç†å¿µï¼ŒViewè¢«åˆ»æ„å†™å¾—å¾ˆè–„ï¼Œå¾ˆå¤šé€»è¾‘å†™åœ¨äº†Modelä¸­ï¼ˆå› ä¸ºModelä¸UIæ¡†æ¶æ— å…³ã€Vueå’ŒReactéƒ½å¯ä»¥å¤ç”¨ï¼‰ã€‚

æ‰€ä»¥éœ€è¦é‡æ„çš„åªæ˜¯Viewï¼Œç”±äºVue3ä¸­å¯ä»¥ä½¿ç”¨`steup+tsx`ï¼Œå¹¶ä¸”`antd-vue`ä¸`antd-react`é£æ ¼å’ŒapiåŸºæœ¬ä¿æŒä¸€è‡´ï¼Œæ‰€ä»¥èƒ½2ä¸ªç‰ˆæœ¬çš„å·®å¼‚å°±æ›´å°äº†ã€‚Vueç‰ˆå…¨ç¨‹ä½¿ç”¨tsxç¼–å†™ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±æ”¹æˆtemplateæ–¹å¼ï¼Œè„šæ‰‹æ¶å·²ç»å†…ç½®äº†å¯¹.vueæ–‡ä»¶çš„æ”¯æŒã€‚ä¹Ÿæ¬¢è¿æœ‰å¿—ä¹‹å£«è´¡çŒ®æºç ï¼Œå°†å…¶é‡æ„ä¸º`templateç‰ˆ`ï¼Œæ–°å¢ä¸€ä¸ªbranchæˆ–forkã€‚

## æ›´å¤šç›¸å…³æ–‡ç« 

- [ä»"å¾®å‰ç«¯"åˆ°â€œå¾®æ¨¡å—â€](https://juejin.cn/post/7106791733509226533)
- [ä¸æƒ³å½“Windowçš„Dialogä¸æ˜¯ä¸€ä¸ªå¥½Modalï¼Œå¼¹çª—ç¿»èº«è®°...](https://juejin.cn/post/7124177821953425422)
- [æ‰‹æ’¸Routerï¼Œè¿˜è¦å•¥Routeræ¡†æ¶ï¼Ÿè®©react-router/vue-routerèººä¸€è¾¹å‡‰å¿«å»](https://juejin.cn/post/7124959667326812196)

## æ„Ÿè°¢å…³æ³¨ï¼Œæ¬¢è¿å‚ä¸

 [eluxjs.com](https://eluxjs.com) | [æ˜é‡‘ä¸“æ ](https://juejin.cn/column/7106899933537501221) | QQ/å¾®ä¿¡äº¤æµç¾¤

![QQç¾¤](https://eluxjs.com/images/qq.jpg)
![å¾®ä¿¡ç¾¤](https://eluxjs.com/images/wechat.jpg)

å¼€æºé¡¹ç›®ï¼Œæ¬¢è¿å‚ä¸è´¡çŒ®æºç (^V^)ï¼è§‰å¾—å¥½ç”¨åˆ«å¿˜äº†[Github](https://github.com/hiisea/elux-react-antd-admin)ç»™ä¸ªStarå“¦(-_-)...
